<div class="p-4 space-y-4 mt-10">
  <h2 class="text-xl text-[#28c76f] font-bold">Checkout</h2>

  <form [formGroup]="checkoutForm" class="space-y-3">
    <mat-form-field
      appearance="outline"
      style="width: 100%"
      class="ion-align-items-center"
    >
      <mat-label class="font-gotham_book text-sm text-black"
        >Customer Name</mat-label
      >
      <input
        matInput
        type="text"
        formControlName="name"
        floatLabel="always"
        placeholder="Enter name"
      />
    </mat-form-field>

    <mat-form-field
      appearance="outline"
      style="width: 100%"
      class="ion-align-items-center"
    >
      <mat-label class="font-gotham_book text-sm text-black"
        >Customer Phone Number</mat-label
      >
      <input
        matInput
        type="text"
        formControlName="phone"
        floatLabel="always"
        placeholder="Enter phone number"
      />
    </mat-form-field>

    @if (suggestedCustomer) {
    <div
      (click)="selectSuggestion()"
      class="mt-1 p-2 bg-green-50 border border-green-200 rounded-xl cursor-pointer hover:bg-green-100 transition-colors"
    >
      <p class="text-xs text-green-700 font-semibold">
        Existing Customer Found:
      </p>
      <p class="text-sm">
        {{ suggestedCustomer.name }} ({{ suggestedCustomer.phone }})
      </p>
      <p class="text-[10px] text-gray-500 italic">Click to auto-fill</p>
    </div>
    }

    <div class="border-t pt-3">
      <p class="font-semibold text-[#28c76f] mb-3">
        Total: ৳ {{ totalAmount | number : "1.0-0" }}
      </p>

      <mat-form-field
        appearance="outline"
        style="width: 100%"
        class="ion-align-items-center"
      >
        <mat-label class="font-gotham_book text-sm text-black"
          >Cash Given</mat-label
        >
        <input
          matInput
          type="number"
          floatLabel="always"
          formControlName="cashGiven"
        />
      </mat-form-field>

      @if((checkoutForm.value.cashGiven || 0) >= totalAmount) {
      <p class="text-green-600 font-medium">
        Change: ৳ {{ changeAmount | number : "1.0-0" }}
      </p>
      }
    </div>

    <div class="flex gap-3 pt-4">
      <button
        type="button"
        class="flex-1 border py-2 rounded-3xl"
        (click)="close()"
        [disabled]="isProcessing"
      >
        Cancel
      </button>

      <button
        type="button"
        class="flex-1 bg-green-600 text-white py-2 rounded-3xl disabled:bg-gray-400"
        (click)="confirmSale()"
        [disabled]="isProcessing"
      >
        {{ isProcessing ? "Processing..." : "Confirm" }}
      </button>
    </div>
  </form>
</div>
